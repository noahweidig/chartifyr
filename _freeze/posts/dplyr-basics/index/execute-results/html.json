{
  "hash": "d5b44a331f402c31554f57a21036fadd",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Basics of dplyr\"\nsubtitle: \"A beginners guide to data wrangling in R\"\nexecute:\n  warning: false\nauthor: \"Noah Weidig\"\ndate: \"2025-02-15\"\ncategories: [code, dplyr, tidyverse]\nimage: \"images/dplyr_wrangling.png\"\ndescription: \"Learn the core dplyr verbs — filter, select, mutate, arrange, summarize, and group_by — using the Palmer Penguins dataset.\"\ntoc: true\ntoc-depth: 2\ncode-fold: show\n---\n\n\n\n[![Artwork by \\@allison_horst](images/dplyr_wrangling.png)](https://twitter.com/allison_horst)\n\nIf you've ever worked with messy data in R, you know how painful base R subsetting can be. The `dplyr` package makes data wrangling intuitive and readable. In this tutorial, we'll walk through the six core dplyr verbs using the Palmer Penguins dataset.\n\n# Setup\n\nLet's load the packages we need.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Uncomment and run these once\n#install.packages(\"tidyverse\")\n#install.packages(\"palmerpenguins\")\n\nlibrary(tidyverse)\nlibrary(palmerpenguins)\n```\n:::\n\n\n\nLet's take a look at the data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Torgersen           39.1          18.7               181        3750\n 2 Adelie  Torgersen           39.5          17.4               186        3800\n 3 Adelie  Torgersen           40.3          18                 195        3250\n 4 Adelie  Torgersen           NA            NA                  NA          NA\n 5 Adelie  Torgersen           36.7          19.3               193        3450\n 6 Adelie  Torgersen           39.3          20.6               190        3650\n 7 Adelie  Torgersen           38.9          17.8               181        3625\n 8 Adelie  Torgersen           39.2          19.6               195        4675\n 9 Adelie  Torgersen           34.1          18.1               193        3475\n10 Adelie  Torgersen           42            20.2               190        4250\n# ℹ 334 more rows\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n\n\n:::\n:::\n\n\n\nWe have 344 penguins with 8 variables: species, island, bill measurements, flipper length, body mass, sex, and year.\n\n# The Pipe Operator\n\nBefore we dive into the verbs, let's talk about the pipe: `|>` (or `%>%`). The pipe takes the output of one function and passes it as the first argument to the next. This lets us chain operations together in a readable way.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Without the pipe\nnrow(penguins)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 344\n```\n\n\n:::\n\n```{.r .cell-code}\n# With the pipe — same result\npenguins |> nrow()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 344\n```\n\n\n:::\n:::\n\n\n\nYou'll see the pipe used throughout this tutorial. Think of it as saying \"and then...\"\n\n# filter()\n\n`filter()` keeps rows that match a condition. Let's grab only the Adelie penguins.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  filter(species == \"Adelie\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 152 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Torgersen           39.1          18.7               181        3750\n 2 Adelie  Torgersen           39.5          17.4               186        3800\n 3 Adelie  Torgersen           40.3          18                 195        3250\n 4 Adelie  Torgersen           NA            NA                  NA          NA\n 5 Adelie  Torgersen           36.7          19.3               193        3450\n 6 Adelie  Torgersen           39.3          20.6               190        3650\n 7 Adelie  Torgersen           38.9          17.8               181        3625\n 8 Adelie  Torgersen           39.2          19.6               195        4675\n 9 Adelie  Torgersen           34.1          18.1               193        3475\n10 Adelie  Torgersen           42            20.2               190        4250\n# ℹ 142 more rows\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n\n\n:::\n:::\n\n\n\nYou can combine multiple conditions. Let's find Adelie penguins that weigh more than 4000 grams.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  filter(species == \"Adelie\", body_mass_g > 4000)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 35 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Torgersen           39.2          19.6               195        4675\n 2 Adelie  Torgersen           42            20.2               190        4250\n 3 Adelie  Torgersen           34.6          21.1               198        4400\n 4 Adelie  Torgersen           42.5          20.7               197        4500\n 5 Adelie  Torgersen           46            21.5               194        4200\n 6 Adelie  Dream               39.2          21.1               196        4150\n 7 Adelie  Dream               39.8          19.1               184        4650\n 8 Adelie  Dream               44.1          19.7               196        4400\n 9 Adelie  Dream               39.6          18.8               190        4600\n10 Adelie  Dream               42.3          21.2               191        4150\n# ℹ 25 more rows\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n\n\n:::\n:::\n\n\n\nUse `|` (or) for either/or conditions.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  filter(island == \"Biscoe\" | island == \"Dream\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 292 × 8\n   species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>           <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Biscoe           37.8          18.3               174        3400\n 2 Adelie  Biscoe           37.7          18.7               180        3600\n 3 Adelie  Biscoe           35.9          19.2               189        3800\n 4 Adelie  Biscoe           38.2          18.1               185        3950\n 5 Adelie  Biscoe           38.8          17.2               180        3800\n 6 Adelie  Biscoe           35.3          18.9               187        3800\n 7 Adelie  Biscoe           40.6          18.6               183        3550\n 8 Adelie  Biscoe           40.5          17.9               187        3200\n 9 Adelie  Biscoe           37.9          18.6               172        3150\n10 Adelie  Biscoe           40.5          18.9               180        3950\n# ℹ 282 more rows\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n\n\n:::\n:::\n\n\n\nA cleaner way to filter for multiple values is `%in%`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  filter(island %in% c(\"Biscoe\", \"Dream\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 292 × 8\n   species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>           <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Biscoe           37.8          18.3               174        3400\n 2 Adelie  Biscoe           37.7          18.7               180        3600\n 3 Adelie  Biscoe           35.9          19.2               189        3800\n 4 Adelie  Biscoe           38.2          18.1               185        3950\n 5 Adelie  Biscoe           38.8          17.2               180        3800\n 6 Adelie  Biscoe           35.3          18.9               187        3800\n 7 Adelie  Biscoe           40.6          18.6               183        3550\n 8 Adelie  Biscoe           40.5          17.9               187        3200\n 9 Adelie  Biscoe           37.9          18.6               172        3150\n10 Adelie  Biscoe           40.5          18.9               180        3950\n# ℹ 282 more rows\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n\n\n:::\n:::\n\n\n\n# select()\n\n`select()` picks specific columns. This is useful when you only need a few variables from a wide dataset.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  select(species, island, body_mass_g)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 × 3\n   species island    body_mass_g\n   <fct>   <fct>           <int>\n 1 Adelie  Torgersen        3750\n 2 Adelie  Torgersen        3800\n 3 Adelie  Torgersen        3250\n 4 Adelie  Torgersen          NA\n 5 Adelie  Torgersen        3450\n 6 Adelie  Torgersen        3650\n 7 Adelie  Torgersen        3625\n 8 Adelie  Torgersen        4675\n 9 Adelie  Torgersen        3475\n10 Adelie  Torgersen        4250\n# ℹ 334 more rows\n```\n\n\n:::\n:::\n\n\n\nYou can also remove columns with a minus sign.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  select(-year)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 × 7\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Torgersen           39.1          18.7               181        3750\n 2 Adelie  Torgersen           39.5          17.4               186        3800\n 3 Adelie  Torgersen           40.3          18                 195        3250\n 4 Adelie  Torgersen           NA            NA                  NA          NA\n 5 Adelie  Torgersen           36.7          19.3               193        3450\n 6 Adelie  Torgersen           39.3          20.6               190        3650\n 7 Adelie  Torgersen           38.9          17.8               181        3625\n 8 Adelie  Torgersen           39.2          19.6               195        4675\n 9 Adelie  Torgersen           34.1          18.1               193        3475\n10 Adelie  Torgersen           42            20.2               190        4250\n# ℹ 334 more rows\n# ℹ 1 more variable: sex <fct>\n```\n\n\n:::\n:::\n\n\n\nThere are handy helper functions too. `starts_with()` grabs columns that start with a string.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  select(species, starts_with(\"bill\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 × 3\n   species bill_length_mm bill_depth_mm\n   <fct>            <dbl>         <dbl>\n 1 Adelie            39.1          18.7\n 2 Adelie            39.5          17.4\n 3 Adelie            40.3          18  \n 4 Adelie            NA            NA  \n 5 Adelie            36.7          19.3\n 6 Adelie            39.3          20.6\n 7 Adelie            38.9          17.8\n 8 Adelie            39.2          19.6\n 9 Adelie            34.1          18.1\n10 Adelie            42            20.2\n# ℹ 334 more rows\n```\n\n\n:::\n:::\n\n\n\n# mutate()\n\n`mutate()` creates new columns or modifies existing ones. Let's convert body mass from grams to kilograms.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  mutate(body_mass_kg = body_mass_g / 1000) |>\n  select(species, body_mass_g, body_mass_kg)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 × 3\n   species body_mass_g body_mass_kg\n   <fct>         <int>        <dbl>\n 1 Adelie         3750         3.75\n 2 Adelie         3800         3.8 \n 3 Adelie         3250         3.25\n 4 Adelie           NA        NA   \n 5 Adelie         3450         3.45\n 6 Adelie         3650         3.65\n 7 Adelie         3625         3.62\n 8 Adelie         4675         4.68\n 9 Adelie         3475         3.48\n10 Adelie         4250         4.25\n# ℹ 334 more rows\n```\n\n\n:::\n:::\n\n\n\nYou can create multiple columns at once.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  mutate(\n    body_mass_kg = body_mass_g / 1000,\n    bill_ratio = bill_length_mm / bill_depth_mm\n  ) |>\n  select(species, body_mass_kg, bill_ratio)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 × 3\n   species body_mass_kg bill_ratio\n   <fct>          <dbl>      <dbl>\n 1 Adelie          3.75       2.09\n 2 Adelie          3.8        2.27\n 3 Adelie          3.25       2.24\n 4 Adelie         NA         NA   \n 5 Adelie          3.45       1.90\n 6 Adelie          3.65       1.91\n 7 Adelie          3.62       2.19\n 8 Adelie          4.68       2   \n 9 Adelie          3.48       1.88\n10 Adelie          4.25       2.08\n# ℹ 334 more rows\n```\n\n\n:::\n:::\n\n\n\n# arrange()\n\n`arrange()` sorts rows. By default, it sorts in ascending order.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  arrange(body_mass_g)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 × 8\n   species   island   bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>     <fct>             <dbl>         <dbl>             <int>       <int>\n 1 Chinstrap Dream              46.9          16.6               192        2700\n 2 Adelie    Biscoe             36.5          16.6               181        2850\n 3 Adelie    Biscoe             36.4          17.1               184        2850\n 4 Adelie    Biscoe             34.5          18.1               187        2900\n 5 Adelie    Dream              33.1          16.1               178        2900\n 6 Adelie    Torgers…           38.6          17                 188        2900\n 7 Chinstrap Dream              43.2          16.6               187        2900\n 8 Adelie    Biscoe             37.9          18.6               193        2925\n 9 Adelie    Dream              37.5          18.9               179        2975\n10 Adelie    Dream              37            16.9               185        3000\n# ℹ 334 more rows\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n\n\n:::\n:::\n\n\n\nUse `desc()` for descending order.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  arrange(desc(body_mass_g))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 × 8\n   species island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>           <dbl>         <dbl>             <int>       <int>\n 1 Gentoo  Biscoe           49.2          15.2               221        6300\n 2 Gentoo  Biscoe           59.6          17                 230        6050\n 3 Gentoo  Biscoe           51.1          16.3               220        6000\n 4 Gentoo  Biscoe           48.8          16.2               222        6000\n 5 Gentoo  Biscoe           45.2          16.4               223        5950\n 6 Gentoo  Biscoe           49.8          15.9               229        5950\n 7 Gentoo  Biscoe           48.4          14.6               213        5850\n 8 Gentoo  Biscoe           49.3          15.7               217        5850\n 9 Gentoo  Biscoe           55.1          16                 230        5850\n10 Gentoo  Biscoe           49.5          16.2               229        5800\n# ℹ 334 more rows\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n\n\n:::\n:::\n\n\n\nYou can sort by multiple columns. This sorts by species first, then by body mass within each species.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  arrange(species, desc(body_mass_g))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 × 8\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g\n   <fct>   <fct>              <dbl>         <dbl>             <int>       <int>\n 1 Adelie  Biscoe              43.2          19                 197        4775\n 2 Adelie  Biscoe              41            20                 203        4725\n 3 Adelie  Torgersen           42.9          17.6               196        4700\n 4 Adelie  Torgersen           39.2          19.6               195        4675\n 5 Adelie  Dream               39.8          19.1               184        4650\n 6 Adelie  Dream               39.6          18.8               190        4600\n 7 Adelie  Biscoe              45.6          20.3               191        4600\n 8 Adelie  Torgersen           42.5          20.7               197        4500\n 9 Adelie  Dream               37.5          18.5               199        4475\n10 Adelie  Torgersen           41.8          19.4               198        4450\n# ℹ 334 more rows\n# ℹ 2 more variables: sex <fct>, year <int>\n```\n\n\n:::\n:::\n\n\n\n# summarize()\n\n`summarize()` (or `summarise()`) collapses the data into a summary. Let's find the average body mass.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  summarize(mean_mass = mean(body_mass_g, na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 1\n  mean_mass\n      <dbl>\n1     4202.\n```\n\n\n:::\n:::\n\n\n\nThe `na.rm = TRUE` argument tells R to ignore missing values. You can compute multiple summaries at once.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  summarize(\n    mean_mass = mean(body_mass_g, na.rm = TRUE),\n    sd_mass = sd(body_mass_g, na.rm = TRUE),\n    n = n()\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 3\n  mean_mass sd_mass     n\n      <dbl>   <dbl> <int>\n1     4202.    802.   344\n```\n\n\n:::\n:::\n\n\n\n# group_by()\n\n`group_by()` is where dplyr really shines. It splits the data into groups so that subsequent operations are performed per group. Pair it with `summarize()` for powerful grouped summaries.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  group_by(species) |>\n  summarize(\n    mean_mass = mean(body_mass_g, na.rm = TRUE),\n    sd_mass = sd(body_mass_g, na.rm = TRUE),\n    n = n()\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 4\n  species   mean_mass sd_mass     n\n  <fct>         <dbl>   <dbl> <int>\n1 Adelie        3701.    459.   152\n2 Chinstrap     3733.    384.    68\n3 Gentoo        5076.    504.   124\n```\n\n\n:::\n:::\n\n\n\nYou can group by multiple variables.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  group_by(species, island) |>\n  summarize(\n    mean_mass = mean(body_mass_g, na.rm = TRUE),\n    n = n(),\n    .groups = \"drop\"\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 4\n  species   island    mean_mass     n\n  <fct>     <fct>         <dbl> <int>\n1 Adelie    Biscoe        3710.    44\n2 Adelie    Dream         3688.    56\n3 Adelie    Torgersen     3706.    52\n4 Chinstrap Dream         3733.    68\n5 Gentoo    Biscoe        5076.   124\n```\n\n\n:::\n:::\n\n\n\nThe `.groups = \"drop\"` argument ungroups the data after summarizing, which is good practice.\n\n# Putting It All Together\n\nThe real power of dplyr is chaining verbs together. Let's find the average flipper length for each species, but only for female penguins weighing over 3500 grams, sorted from longest to shortest.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins |>\n  filter(sex == \"female\", body_mass_g > 3500) |>\n  group_by(species) |>\n  summarize(\n    mean_flipper = mean(flipper_length_mm, na.rm = TRUE),\n    n = n()\n  ) |>\n  arrange(desc(mean_flipper))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 3\n  species   mean_flipper     n\n  <fct>            <dbl> <int>\n1 Gentoo            213.    58\n2 Chinstrap         192.    19\n3 Adelie            190.    22\n```\n\n\n:::\n:::\n\n\n\nEach step is readable on its own, and the pipe makes the full pipeline easy to follow.\n\n# Quick Reference\n\n| Verb | What it does |\n|------|-------------|\n| `filter()` | Keep rows that match a condition |\n| `select()` | Pick or remove columns |\n| `mutate()` | Create or modify columns |\n| `arrange()` | Sort rows |\n| `summarize()` | Collapse data into summaries |\n| `group_by()` | Group data for per-group operations |\n\nAnd that's it! These six verbs will cover the vast majority of your data wrangling needs. Thanks for reading — keep an eye out for more R tutorials!\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}